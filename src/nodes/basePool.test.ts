import { BasePool, findNearestInitializedTickIndex } from "./basePool";
import { toSqrtRatio } from "../math/tick";
import { describe, expect, it } from "vitest";

describe(findNearestInitializedTickIndex, () => {
  it("no ticks", () => {
    expect(findNearestInitializedTickIndex([], 0)).toBe(-1);
  });
  it("one tick less than", () => {
    expect(
      findNearestInitializedTickIndex([{ tick: -1, liquidityDelta: 1n }], 0),
    ).toBe(0);
  });
  it("one tick equal to", () => {
    expect(
      findNearestInitializedTickIndex([{ tick: 0, liquidityDelta: 1n }], 0),
    ).toBe(0);
  });
  it("one tick greater than", () => {
    expect(
      findNearestInitializedTickIndex([{ tick: 1, liquidityDelta: 1n }], 0),
    ).toBe(-1);
  });
  it("many ticks", () => {
    const sortedTicks = [
      { tick: -100, liquidityDelta: 0n },
      { tick: -5, liquidityDelta: 0n },
      { tick: -4, liquidityDelta: 0n },
      { tick: 18, liquidityDelta: 0n },
      { tick: 23, liquidityDelta: 0n },
      { tick: 50, liquidityDelta: 0n },
    ];
    expect(findNearestInitializedTickIndex(sortedTicks, -101)).toBe(-1);
    expect(findNearestInitializedTickIndex(sortedTicks, -100)).toBe(0);
    expect(findNearestInitializedTickIndex(sortedTicks, -99)).toBe(0);
    expect(findNearestInitializedTickIndex(sortedTicks, -6)).toBe(0);
    expect(findNearestInitializedTickIndex(sortedTicks, -5)).toBe(1);
    expect(findNearestInitializedTickIndex(sortedTicks, -4)).toBe(2);
    expect(findNearestInitializedTickIndex(sortedTicks, -3)).toBe(2);
    expect(findNearestInitializedTickIndex(sortedTicks, 0)).toBe(2);
    expect(findNearestInitializedTickIndex(sortedTicks, 17)).toBe(2);
    expect(findNearestInitializedTickIndex(sortedTicks, 18)).toBe(3);
    expect(findNearestInitializedTickIndex(sortedTicks, 19)).toBe(3);
    expect(findNearestInitializedTickIndex(sortedTicks, 22)).toBe(3);
    expect(findNearestInitializedTickIndex(sortedTicks, 23)).toBe(4);
    expect(findNearestInitializedTickIndex(sortedTicks, 24)).toBe(4);
    expect(findNearestInitializedTickIndex(sortedTicks, 49)).toBe(4);
    expect(findNearestInitializedTickIndex(sortedTicks, 50)).toBe(5);
    expect(findNearestInitializedTickIndex(sortedTicks, 51)).toBe(5);
  });
});

describe(BasePool, () => {
  describe("quote", () => {
    it("works for 0 liquidity 1 token1 input", () => {
      const pool = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 0n,
        tick: 0,
        sortedTicks: [],
        liquidity: 0n,
        sqrtRatio: 1n << 128n,
      });

      const { executionResources, calculatedAmount } = pool.quote({
        tokenAmount: {
          amount: 1n,
          token: 1n,
        },
        meta: { block: { number: 1, time: 2 } },
      });

      expect(calculatedAmount).toEqual(0n);
      expect(executionResources.initializedTicksCrossed).toEqual(0);
    });
    it("works for 0 liquidity 1 token0 input", () => {
      const pool = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 0n,
        tick: 0,
        sortedTicks: [],
        liquidity: 0n,
        sqrtRatio: 1n << 128n,
      });

      const { executionResources, calculatedAmount } = pool.quote({
        tokenAmount: {
          amount: 1n,
          token: 0n,
        },
        meta: { block: { number: 1, time: 2 } },
      });

      expect(calculatedAmount).toEqual(0n);
      expect(executionResources.initializedTicksCrossed).toEqual(0);
    });

    it("works for 10000 liquidity 1000 token1 input", () => {
      const pool = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 0n,
        tick: 0,
        sortedTicks: [
          { tick: 0, liquidityDelta: 1000000000n },
          { tick: 1, liquidityDelta: -1000000000n },
        ],
        liquidity: 1000000000n,
        sqrtRatio: 1n << 128n,
      });

      const { executionResources, calculatedAmount } = pool.quote({
        tokenAmount: {
          amount: 1000n,
          token: 1n,
        },
        meta: { block: { number: 1, time: 2 } },
      });

      expect(calculatedAmount).toEqual(499n);
      expect(executionResources.initializedTicksCrossed).toEqual(1);
    });
    it("works for 10000 liquidity 1000 token1 input", () => {
      const pool = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 0n,
        tick: 1,
        sortedTicks: [
          { tick: 0, liquidityDelta: 1000000000n },
          { tick: 1, liquidityDelta: -1000000000n },
        ],
        liquidity: 0n,
        sqrtRatio: toSqrtRatio(1),
      });

      const { executionResources, calculatedAmount } = pool.quote({
        tokenAmount: {
          amount: 1000n,
          token: 0n,
        },
        meta: { block: { number: 1, time: 2 } },
      });

      expect(calculatedAmount).toEqual(499n);
      expect(executionResources.initializedTicksCrossed).toEqual(2);
    });

    it("eth usdc example pool", () => {
      const node = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 1020847100762815411640772995208708096n,
        sqrtRatio: 15563001745813054266804011142814305n,
        tick: -19985280,
        sortedTicks: [
          { tick: -43058436, liquidityDelta: "6896952815" },
          { tick: -41455260, liquidityDelta: "3352933856364109" },
          { tick: -41449278, liquidityDelta: "-3352933856364109" },
          { tick: -39152190, liquidityDelta: "1060034353279" },
          { tick: -39146208, liquidityDelta: "-1043046221961" },
          { tick: -37537050, liquidityDelta: "120292523066347" },
          { tick: -37351608, liquidityDelta: "-120292523066347" },
          { tick: -36843138, liquidityDelta: "3208538392" },
          { tick: -34540068, liquidityDelta: "2501859512420" },
          { tick: -32242980, liquidityDelta: "66993828499244" },
          { tick: -32236998, liquidityDelta: "-68094263403972" },
          { tick: -31549068, liquidityDelta: "26044527670966" },
          { tick: -31543086, liquidityDelta: "-26044527670966" },
          { tick: -31142292, liquidityDelta: "52162370892824" },
          { tick: -31136310, liquidityDelta: "-52162370892824" },
          { tick: -30155262, liquidityDelta: "4833371383034" },
          { tick: -30053568, liquidityDelta: "9047048399" },
          { tick: -30041604, liquidityDelta: "-4833371383034" },
          { tick: -29939910, liquidityDelta: "467647896659234" },
          { tick: -29933928, liquidityDelta: "-467638048200443" },
          { tick: -29820270, liquidityDelta: "53311280614663" },
          { tick: -29754468, liquidityDelta: "13600627870" },
          { tick: -29748486, liquidityDelta: "-53311280614663" },
          { tick: -29245998, liquidityDelta: "224563934660361" },
          { tick: -29240016, liquidityDelta: "-224563934660361" },
          { tick: -29018682, liquidityDelta: "499574004481" },
          { tick: -28833240, liquidityDelta: "2506425496" },
          { tick: -28737528, liquidityDelta: "1741514948837997" },
          { tick: -28731546, liquidityDelta: "-1741514948837997" },
          { tick: -28426464, liquidityDelta: "225336135468560" },
          { tick: -28420482, liquidityDelta: "-225336135468560" },
          { tick: -28330752, liquidityDelta: "473669815258994" },
          { tick: -28324770, liquidityDelta: "-473649911335722" },
          { tick: -28037634, liquidityDelta: "167610347017" },
          { tick: -20225142, liquidityDelta: "-588153032353880" },
          { tick: -20213178, liquidityDelta: "410665542037683" },
          { tick: -20165322, liquidityDelta: "-393109696912163" },
          { tick: -20147376, liquidityDelta: "-131943367474773" },
          { tick: -27624876, liquidityDelta: "-333807226990762" },
          { tick: -27457380, liquidityDelta: "367287992789220" },
          { tick: -27451398, liquidityDelta: "-367287992789220" },
          { tick: -27224082, liquidityDelta: "68708790020" },
          { tick: -26936946, liquidityDelta: "-614086015786" },
          { tick: -26536152, liquidityDelta: "5793015907001" },
          { tick: -26530170, liquidityDelta: "-5793015907001" },
          { tick: -26021700, liquidityDelta: "207541311270" },
          { tick: -26003754, liquidityDelta: "130942688664" },
          { tick: -25949916, liquidityDelta: "409413556116" },
          { tick: -23383638, liquidityDelta: "43956590943870" },
          { tick: -23252034, liquidityDelta: "-43956590943870" },
          { tick: -22761510, liquidityDelta: "12534649315" },
          { tick: -22689726, liquidityDelta: "12370667010" },
          { tick: -22528212, liquidityDelta: "9047859950" },
          { tick: -21930012, liquidityDelta: "10203018113" },
          { tick: -21912066, liquidityDelta: "43472246222" },
          { tick: -21864210, liquidityDelta: "70849648133" },
          { tick: -21858228, liquidityDelta: "10425233990" },
          { tick: -21792426, liquidityDelta: "12498380831" },
          { tick: -21780462, liquidityDelta: "14343205689" },
          { tick: -21768498, liquidityDelta: "32210230722" },
          { tick: -21630912, liquidityDelta: "13229154682" },
          { tick: -21547164, liquidityDelta: "51255838424" },
          { tick: -21541182, liquidityDelta: "51421204552" },
          { tick: -21523236, liquidityDelta: "15811488410" },
          { tick: -21517254, liquidityDelta: "520834635436" },
          { tick: -21511272, liquidityDelta: "15317388059" },
          { tick: -21505290, liquidityDelta: "52447160042" },
          { tick: -21487344, liquidityDelta: "8840829275" },
          { tick: -21469398, liquidityDelta: "10155871628" },
          { tick: -21463416, liquidityDelta: "53641782635" },
          { tick: -21457434, liquidityDelta: "53830703475" },
          { tick: -21445470, liquidityDelta: "22818952388" },
          { tick: -21427524, liquidityDelta: "48629359688" },
          { tick: -21421542, liquidityDelta: "14898243985" },
          { tick: -21379668, liquidityDelta: "70849648868" },
          { tick: -21373686, liquidityDelta: "51020537238" },
          { tick: -21337794, liquidityDelta: "71395429280" },
          { tick: -21325830, liquidityDelta: "10331636888" },
          { tick: -21319848, liquidityDelta: "459049799872" },
          { tick: -21307884, liquidityDelta: "13852587334" },
          { tick: -21266010, liquidityDelta: "39780212232" },
          { tick: -21254046, liquidityDelta: "19164082833" },
          { tick: -21236100, liquidityDelta: "68693504680" },
          { tick: -21218154, liquidityDelta: "83082471025" },
          { tick: -21212172, liquidityDelta: "63731931265" },
          { tick: -21206190, liquidityDelta: "121563051454" },
          { tick: -21152352, liquidityDelta: "1022287258441" },
          { tick: -21098514, liquidityDelta: "22742022882" },
          { tick: -21080568, liquidityDelta: "642709944762" },
          { tick: -21056640, liquidityDelta: "72908073660" },
          { tick: -21032712, liquidityDelta: "11666960911" },
          { tick: -21026730, liquidityDelta: "225824226723" },
          { tick: -21008784, liquidityDelta: "273960691371" },
          { tick: -21002802, liquidityDelta: "35325020179" },
          { tick: -20948964, liquidityDelta: "94779928001" },
          { tick: -20841288, liquidityDelta: "20935955202583" },
          { tick: -20829324, liquidityDelta: "7645254177845" },
          { tick: -20727630, liquidityDelta: "31739554406232" },
          { tick: -20715666, liquidityDelta: "167933319705" },
          { tick: -20057646, liquidityDelta: "-145259052039875" },
          { tick: -20679774, liquidityDelta: "90619279" },
          { tick: -20673792, liquidityDelta: "47842482443439" },
          { tick: -20655846, liquidityDelta: "3993159608487" },
          { tick: -20649864, liquidityDelta: "47899961149985" },
          { tick: -20643882, liquidityDelta: "6668817290" },
          { tick: -20637900, liquidityDelta: "98737343997" },
          { tick: -20607990, liquidityDelta: "137993174821" },
          { tick: -20590044, liquidityDelta: "1832404103004" },
          { tick: -20584062, liquidityDelta: "8576399704436" },
          { tick: -20578080, liquidityDelta: "4873368473463" },
          { tick: -20560134, liquidityDelta: "1192143980595" },
          { tick: -20548170, liquidityDelta: "125656720638065" },
          { tick: -20536206, liquidityDelta: "100242175459519" },
          { tick: -20524242, liquidityDelta: "1180077982972" },
          { tick: -20512278, liquidityDelta: "34703274608160" },
          { tick: -20494332, liquidityDelta: "4450645450428" },
          { tick: -20476386, liquidityDelta: "208339037312993" },
          { tick: -19973898, liquidityDelta: "-118408478971602" },
          { tick: -20470404, liquidityDelta: "11323356684907" },
          { tick: -20452458, liquidityDelta: "114409015650033" },
          { tick: -20446476, liquidityDelta: "49756883325" },
          { tick: -20440494, liquidityDelta: "79746627198526" },
          { tick: -20434512, liquidityDelta: "104998118653760" },
          { tick: -20428530, liquidityDelta: "3842720641877" },
          { tick: -19914078, liquidityDelta: "-45448528179991" },
          { tick: -20314872, liquidityDelta: "694748864904503" },
          { tick: -20308890, liquidityDelta: "97764119779844" },
          { tick: -20027736, liquidityDelta: "-260036165247669" },
          { tick: -20386656, liquidityDelta: "468843704545748" },
          { tick: -19955952, liquidityDelta: "-77218525086579" },
          { tick: -20045682, liquidityDelta: "-1870639044618" },
          { tick: -20039700, liquidityDelta: "-893869869022" },
          { tick: -19938006, liquidityDelta: "-52022937618" },
          { tick: -19908096, liquidityDelta: "-24123773053" },
          { tick: -19902114, liquidityDelta: "-110779768092" },
          { tick: -19896132, liquidityDelta: "12809586392559" },
          { tick: -19890150, liquidityDelta: "-17564899788083" },
          { tick: -19878186, liquidityDelta: "-1291826510961" },
          { tick: -19854258, liquidityDelta: "-173873927603875" },
          { tick: -19842294, liquidityDelta: "-6670332014" },
          { tick: -19830330, liquidityDelta: "-177829874635" },
          { tick: -19824348, liquidityDelta: "-611722616574" },
          { tick: -19812384, liquidityDelta: "23375386143104" },
          { tick: -19800420, liquidityDelta: "-6698687586105" },
          { tick: -19794438, liquidityDelta: "-68693504680" },
          { tick: -19782474, liquidityDelta: "-88564966206" },
          { tick: -19776492, liquidityDelta: "175957704865" },
          { tick: -19764528, liquidityDelta: "-17049968350288" },
          { tick: -19752564, liquidityDelta: "-47012706131" },
          { tick: -19740600, liquidityDelta: "-4202742407458" },
          { tick: -19734618, liquidityDelta: "17358708971519" },
          { tick: -19728636, liquidityDelta: "-17360441818752" },
          { tick: -19692744, liquidityDelta: "-1372322390584" },
          { tick: -19680780, liquidityDelta: "-285191962055" },
          { tick: -19662834, liquidityDelta: "-10594424258569" },
          { tick: -19656852, liquidityDelta: "-6040014435581" },
          { tick: -19644888, liquidityDelta: "-58945160772" },
          { tick: -19638906, liquidityDelta: "-7084004384789" },
          { tick: -19608996, liquidityDelta: "-3124426224004" },
          { tick: -19603014, liquidityDelta: "-5970553379138" },
          { tick: -19597032, liquidityDelta: "-3102899586333" },
          { tick: -19591050, liquidityDelta: "-662524517417" },
          { tick: -19531230, liquidityDelta: "3435165852383" },
          { tick: -20410584, liquidityDelta: "81109123889229" },
          { tick: -20398620, liquidityDelta: "575385243640906" },
          { tick: -19465428, liquidityDelta: "-11880194060959" },
          { tick: -19453464, liquidityDelta: "-12156513682770" },
          { tick: -19447482, liquidityDelta: "-1832404103004" },
          { tick: -19441500, liquidityDelta: "-4684561926847" },
          { tick: -20374692, liquidityDelta: "489704023566821" },
          { tick: -20368710, liquidityDelta: "241591869531203" },
          { tick: -20362728, liquidityDelta: "364188464322766" },
          { tick: -20356746, liquidityDelta: "485430257381128" },
          { tick: -19393644, liquidityDelta: "-132443123685" },
          { tick: -20350764, liquidityDelta: "4433834247341527" },
          { tick: -19369716, liquidityDelta: "-8281899336654" },
          { tick: -20338800, liquidityDelta: "1207050324281767" },
          { tick: -20332818, liquidityDelta: "2646695449634794" },
          { tick: -19363734, liquidityDelta: "-96932382880" },
          { tick: -20326836, liquidityDelta: "6475767853929939" },
          { tick: -20320854, liquidityDelta: "1906599707160487" },
          { tick: -20302908, liquidityDelta: "63720440104706" },
          { tick: -19214184, liquidityDelta: "-8980265773009" },
          { tick: -19208202, liquidityDelta: "-18316291160" },
          { tick: -19136418, liquidityDelta: "-187692104694" },
          { tick: -19106508, liquidityDelta: "-4501573382011" },
          { tick: -19022760, liquidityDelta: "-86178335513" },
          { tick: -18962940, liquidityDelta: "-43120690911" },
          { tick: -18950976, liquidityDelta: "-44059031852" },
          { tick: -18873210, liquidityDelta: "4195134449702" },
          { tick: -18807408, liquidityDelta: "-18037292270" },
          { tick: -18789462, liquidityDelta: "-18636018713" },
          { tick: -18759552, liquidityDelta: "-17442563205" },
          { tick: -18729642, liquidityDelta: "-11666960911" },
          { tick: -18681786, liquidityDelta: "-8840829275" },
          { tick: -18657858, liquidityDelta: "-36391520824" },
          { tick: -18633930, liquidityDelta: "-22742022882" },
          { tick: -18586074, liquidityDelta: "-7454407485" },
          { tick: -18580092, liquidityDelta: "-10203018113" },
          { tick: -18574110, liquidityDelta: "-15317388059" },
          { tick: -18562146, liquidityDelta: "-27994701197" },
          { tick: -18538218, liquidityDelta: "-24029855818" },
          { tick: -18526254, liquidityDelta: "-13988334024" },
          { tick: -18514290, liquidityDelta: "-39780212232" },
          { tick: -18490362, liquidityDelta: "-13229154682" },
          { tick: -18460452, liquidityDelta: "-840393873" },
          { tick: -18448488, liquidityDelta: "-90619279" },
          { tick: -18442506, liquidityDelta: "-695421284" },
          { tick: -20261034, liquidityDelta: "362958696035425" },
          { tick: -18418578, liquidityDelta: "2537531407457" },
          { tick: -18412596, liquidityDelta: "-3351905253181" },
          { tick: -18316884, liquidityDelta: "-6668817290" },
          { tick: -18233136, liquidityDelta: "-13250446358" },
          { tick: -18149388, liquidityDelta: "-9047048399" },
          { tick: -18083586, liquidityDelta: "-10425233990" },
          { tick: -18035730, liquidityDelta: "10750712834" },
          { tick: -18017784, liquidityDelta: "-10834604807" },
          { tick: -17904126, liquidityDelta: "-9047859950" },
          { tick: -17892162, liquidityDelta: "-19761665575" },
          { tick: -17832342, liquidityDelta: "-10155871628" },
          { tick: -17796450, liquidityDelta: "-10750712834" },
          { tick: -17778504, liquidityDelta: "-14343205689" },
          { tick: -17736630, liquidityDelta: "-17287727909" },
          { tick: -17724666, liquidityDelta: "-129186371705" },
          { tick: -17090574, liquidityDelta: "-33032390407" },
          { tick: -16127472, liquidityDelta: "-12219516339" },
          { tick: -16115508, liquidityDelta: "-34550169033" },
          { tick: -20255052, liquidityDelta: "1830093392063465" },
          { tick: -15583110, liquidityDelta: "-14898243985" },
          { tick: -15475434, liquidityDelta: "-14198425339" },
          { tick: -15415614, liquidityDelta: "-124949865" },
          { tick: -11515350, liquidityDelta: "-434534950831" },
          { tick: -20249070, liquidityDelta: "195079514253150" },
          { tick: -20243088, liquidityDelta: "108003515808077" },
          { tick: -20207196, liquidityDelta: "-319371656471836" },
          { tick: -20195232, liquidityDelta: "-147017384543814" },
          { tick: -20189250, liquidityDelta: "-67060531610571" },
          { tick: -20171304, liquidityDelta: "-111294922560217" },
          { tick: -20135412, liquidityDelta: "-630255928614633" },
          { tick: -20129430, liquidityDelta: "-294640651482138" },
          { tick: -20123448, liquidityDelta: "-361262865236242" },
          { tick: -20117466, liquidityDelta: "-452012044138012" },
          { tick: -20111484, liquidityDelta: "-4415107665045177" },
          { tick: -20099520, liquidityDelta: "-1057100005109185" },
          { tick: -20093538, liquidityDelta: "-2812419504032366" },
          { tick: -20087556, liquidityDelta: "-6084177470294622" },
          { tick: -20081574, liquidityDelta: "-2546479093100808" },
          { tick: -20063628, liquidityDelta: "-40209366741372" },
          { tick: -20033718, liquidityDelta: "-8021014147311" },
          { tick: -20015772, liquidityDelta: "-1009756049877202" },
          { tick: -20009790, liquidityDelta: "-162837632816018" },
          { tick: -20003808, liquidityDelta: "-182653404149054" },
          { tick: -19979880, liquidityDelta: "-161576954484401" },
          { tick: -19967916, liquidityDelta: "-376694484637826" },
          { tick: -19949970, liquidityDelta: "-14966499961026" },
          { tick: -19872204, liquidityDelta: "-24560253792094" },
          { tick: -19860240, liquidityDelta: "-353193742217869" },
          { tick: -19848276, liquidityDelta: "-364396442360706" },
          { tick: -20380674, liquidityDelta: "702127039281324" },
          { tick: -20141394, liquidityDelta: "-692372577608127" },
          { tick: 20087556, liquidityDelta: "2040795524385285087" },
          { tick: 20326836, liquidityDelta: "-2040795524385285087" },
          { tick: -20105502, liquidityDelta: "-1675649798191306" },
          { tick: -19866222, liquidityDelta: "-2765641552156" },
          { tick: -20554152, liquidityDelta: "52658688463146" },
          { tick: -20518260, liquidityDelta: "87138481224437" },
          { tick: 88719042, liquidityDelta: "-10553216920139" },
          { tick: -88719042, liquidityDelta: "11729508586897" },
          { tick: -33846156, liquidityDelta: "3674516776725" },
          { tick: -27750498, liquidityDelta: "6770166518408033" },
          { tick: -19525248, liquidityDelta: "-16007616393751" },
          { tick: -27636840, liquidityDelta: "997750394211138" },
          { tick: -20972892, liquidityDelta: "9250371148752" },
          { tick: -20566116, liquidityDelta: "546447009134" },
          { tick: -27630858, liquidityDelta: "-664850411169272" },
          { tick: -27511218, liquidityDelta: "-6771621085306797" },
          { tick: -26243034, liquidityDelta: "-3674516776725" },
          { tick: -21415560, liquidityDelta: "139359362491" },
          { tick: -20721648, liquidityDelta: "53221888622185" },
          { tick: -20625936, liquidityDelta: "14268823223026" },
          { tick: -20619954, liquidityDelta: "63438716574146" },
          { tick: -20542188, liquidityDelta: "68347033104134" },
          { tick: -20500314, liquidityDelta: "17709398232952" },
          { tick: -20482368, liquidityDelta: "13378468599020" },
          { tick: -20458440, liquidityDelta: "327273812517940" },
          { tick: -20422548, liquidityDelta: "1931184196766" },
          { tick: -20416566, liquidityDelta: "-19708014356970" },
          { tick: -20404602, liquidityDelta: "133842300082579" },
          { tick: -20392638, liquidityDelta: "242919689814208" },
          { tick: -20344782, liquidityDelta: "920462051765137" },
          { tick: -20296926, liquidityDelta: "402194082106762" },
          { tick: -20290944, liquidityDelta: "137048493643935" },
          { tick: -20284962, liquidityDelta: "733546876922176" },
          { tick: -20278980, liquidityDelta: "123680061209562" },
          { tick: -20272998, liquidityDelta: "69041423108817" },
          { tick: -20267016, liquidityDelta: "247161517331367" },
          { tick: -20237106, liquidityDelta: "175997855611794" },
          { tick: -20231124, liquidityDelta: "1140305715624951" },
          { tick: -20219160, liquidityDelta: "-144892487523091" },
          { tick: -20201214, liquidityDelta: "-257912081118844" },
          { tick: -20183268, liquidityDelta: "-108825266583390" },
          { tick: -20177286, liquidityDelta: "-48399236175472" },
          { tick: -20159340, liquidityDelta: "-318273164950904" },
          { tick: -20153358, liquidityDelta: "-291191457251910" },
          { tick: -20075592, liquidityDelta: "-193126551496805" },
          { tick: -20069610, liquidityDelta: "-57712455322" },
          { tick: -20051664, liquidityDelta: "-47712772828408" },
          { tick: -20021754, liquidityDelta: "-475551041391763" },
          { tick: -19997826, liquidityDelta: "-183356011952224" },
          { tick: -19991844, liquidityDelta: "-144529123061283" },
          { tick: -19985862, liquidityDelta: "-339316483046009" },
          { tick: -19961934, liquidityDelta: "-107784813623896" },
          { tick: -19932024, liquidityDelta: "-447460390365490" },
          { tick: -19926042, liquidityDelta: "-64466812031283" },
          { tick: -19920060, liquidityDelta: "-83095322598448" },
          { tick: -19884168, liquidityDelta: "-6209819519553" },
          { tick: -19818366, liquidityDelta: "-8763574035894" },
          { tick: -19806402, liquidityDelta: "-17566680572387" },
          { tick: -19788456, liquidityDelta: "-14390139766101" },
          { tick: -19770510, liquidityDelta: "12750268060247" },
          { tick: -19668816, liquidityDelta: "-19890239686705" },
          { tick: -19626942, liquidityDelta: "-12922143156181" },
          { tick: -19585068, liquidityDelta: "11004376023849" },
          { tick: -19471410, liquidityDelta: "3770372736521" },
          { tick: -19339806, liquidityDelta: "-2276719198140" },
          { tick: -19220166, liquidityDelta: "-55501931529020" },
          { tick: -19112490, liquidityDelta: "-23161810068474" },
          { tick: -18933030, liquidityDelta: "-44298158633" },
          { tick: -18867228, liquidityDelta: "-4195134449702" },
          { tick: -18849282, liquidityDelta: "-11015522391348" },
          { tick: -18777498, liquidityDelta: "-37063887018" },
          { tick: -18645894, liquidityDelta: "-7243067296517" },
        ]
          .sort(({ tick: t1 }, { tick: t2 }) => t1 - t2)
          .map(({ tick, liquidityDelta }) => ({
            tick,
            liquidityDelta: BigInt(liquidityDelta),
          })),
        liquidity: 2695287607686846n,
      });

      expect(
        node.quote({
          tokenAmount: {
            amount: 2000_000_000n,
            token: 1n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 936197803980535666n,
          "consumedAmount": 2000000000n,
          "executionResources": {
            "initializedTicksCrossed": 6,
            "tickSpacingsCrossed": 156,
          },
          "feesPaid": 6000004n,
          "isPriceIncreasing": true,
          "stateAfter": {
            "activeTickIndex": 216,
            "liquidity": 1838637850921516n,
            "sqrtRatio": 15872195688912137691253264112597002n,
          },
        }
      `);

      expect(
        node.quote({
          tokenAmount: {
            amount: 20_000_000_000n,
            token: 1n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 3452798867537863676n,
          "consumedAmount": 20000000000n,
          "executionResources": {
            "initializedTicksCrossed": 117,
            "tickSpacingsCrossed": 25385,
          },
          "feesPaid": 60000060n,
          "isPriceIncreasing": true,
          "stateAfter": {
            "activeTickIndex": 327,
            "liquidity": 10987751870970n,
            "sqrtRatio": 376461622467786581012265718470693082n,
          },
        }
      `);

      expect(
        node.quote({
          tokenAmount: {
            amount: 10n ** 18n,
            token: 0n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 2056014996n,
          "consumedAmount": 1000000000000000000n,
          "executionResources": {
            "initializedTicksCrossed": 5,
            "tickSpacingsCrossed": 108,
          },
          "feesPaid": 3000000000000001n,
          "isPriceIncreasing": false,
          "stateAfter": {
            "activeTickIndex": 205,
            "liquidity": 3707980262711434n,
            "sqrtRatio": 15351710788920282815253545876633442n,
          },
        }
      `);

      expect(
        node.quote({
          tokenAmount: {
            amount: 10n ** 19n,
            token: 0n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 19231691709n,
          "consumedAmount": 10000000000000000000n,
          "executionResources": {
            "initializedTicksCrossed": 21,
            "tickSpacingsCrossed": 491,
          },
          "feesPaid": 30000000000000009n,
          "isPriceIncreasing": false,
          "stateAfter": {
            "activeTickIndex": 189,
            "liquidity": 20066300368579088n,
            "sqrtRatio": 14632357786369744003669228231884916n,
          },
        }
      `);

      expect(
        node.quote({
          tokenAmount: {
            amount: -2_000_000_000n,
            token: 1n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 972405083420031733n,
          "consumedAmount": -2000000000n,
          "executionResources": {
            "initializedTicksCrossed": 5,
            "tickSpacingsCrossed": 106,
          },
          "feesPaid": 2917215250260097n,
          "isPriceIncreasing": false,
          "stateAfter": {
            "activeTickIndex": 205,
            "liquidity": 3707980262711434n,
            "sqrtRatio": 15356851300529036295687296777661975n,
          },
        }
      `);
      expect(
        node.quote({
          tokenAmount: {
            amount: -20_000_000_000n,
            token: 1n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 10417135837307225847n,
          "consumedAmount": -20000000000n,
          "executionResources": {
            "initializedTicksCrossed": 21,
            "tickSpacingsCrossed": 498,
          },
          "feesPaid": 31251407511921686n,
          "isPriceIncreasing": false,
          "stateAfter": {
            "activeTickIndex": 189,
            "liquidity": 20066300368579088n,
            "sqrtRatio": 14619328889221429322165582949273604n,
          },
        }
      `);
      expect(
        node.quote({
          tokenAmount: {
            amount: -1n * 10n ** 18n,
            token: 0n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 2139456613n,
          "consumedAmount": -1000000000000000000n,
          "executionResources": {
            "initializedTicksCrossed": 6,
            "tickSpacingsCrossed": 169,
          },
          "feesPaid": 6418374n,
          "isPriceIncreasing": true,
          "stateAfter": {
            "activeTickIndex": 216,
            "liquidity": 1838637850921516n,
            "sqrtRatio": 15897927924484882480384197655799943n,
          },
        }
      `);
      expect(
        node.quote({
          tokenAmount: {
            amount: -1n * 10n ** 19n,
            token: 0n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 194883586930788271243317027501365n,
          "consumedAmount": -3462603080395210725n,
          "executionResources": {
            "initializedTicksCrossed": 121,
            "tickSpacingsCrossed": 433100,
          },
          "feesPaid": 584650760792364825900439882497n,
          "isPriceIncreasing": true,
          "stateAfter": {
            "activeTickIndex": 331,
            "liquidity": 0n,
            "sqrtRatio": 6277100250585753475930931601400621808602321654880405518632n,
          },
        }
      `);
    });

    it("eth dai example pool", () => {
      const node = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 170141183460469235273462165868118016n,
        sqrtRatio: 7447172931220104502713977734064586728n,
        tick: -7643887,
        sortedTicks: [
          { tick: -88722000, liquidityDelta: "2860510155421620368" },
          { tick: -41447000, liquidityDelta: "265612361014198" },
          { tick: -32342000, liquidityDelta: "4052686" },
          { tick: -25434000, liquidityDelta: "24320875" },
          { tick: -25329000, liquidityDelta: "6324720684291002370" },
          { tick: -25328000, liquidityDelta: "-6324720684291002370" },
          { tick: -23131000, liquidityDelta: "28379730" },
          { tick: -20829000, liquidityDelta: "40582930" },
          { tick: -18526000, liquidityDelta: "69171479" },
          { tick: -18421000, liquidityDelta: "24156317064804089" },
          { tick: -16633000, liquidityDelta: "40950678" },
          { tick: -16223000, liquidityDelta: "36928774" },
          { tick: -16118000, liquidityDelta: "758943537562535" },
          { tick: -15426000, liquidityDelta: "44733543218737876918" },
          { tick: -15425000, liquidityDelta: "-44733543218737876918" },
          { tick: -14331000, liquidityDelta: "4184732911" },
          { tick: -14329000, liquidityDelta: "41849157" },
          { tick: -14326000, liquidityDelta: "56113644" },
          { tick: -14306000, liquidityDelta: "418554362" },
          { tick: -14300000, liquidityDelta: "41876383" },
          { tick: -14299000, liquidityDelta: "144433471" },
          { tick: -14292000, liquidityDelta: "8374893913" },
          { tick: -14097000, liquidityDelta: "42012" },
          { tick: -13932000, liquidityDelta: "54848" },
          { tick: -13921000, liquidityDelta: "50588924" },
          { tick: -13817000, liquidityDelta: "462340108273" },
          { tick: -13816000, liquidityDelta: "746521504285994" },
          { tick: -13634000, liquidityDelta: "2556428633413664448" },
          { tick: -13633000, liquidityDelta: "-2556428633413664448" },
          { tick: -13480000, liquidityDelta: "2874179586619847026" },
          { tick: -13479000, liquidityDelta: "-2874179586619847026" },
          { tick: -12270000, liquidityDelta: "44427582" },
          { tick: -12166000, liquidityDelta: "7380011855923" },
          { tick: -12041000, liquidityDelta: "583630441524078" },
          { tick: -12028000, liquidityDelta: "45003" },
          { tick: -12017000, liquidityDelta: "4503309" },
          { tick: -12004000, liquidityDelta: "29317665073" },
          { tick: -11998000, liquidityDelta: "45078" },
          { tick: -11997000, liquidityDelta: "45080" },
          { tick: -11990000, liquidityDelta: "45135380405" },
          { tick: -11949000, liquidityDelta: "15383056" },
          { tick: -11889000, liquidityDelta: "20432060" },
          { tick: -11725000, liquidityDelta: "549763" },
          { tick: -11724000, liquidityDelta: "160824311925850" },
          { tick: -11629000, liquidityDelta: "461035771" },
          { tick: -11623000, liquidityDelta: "46134045" },
          { tick: -11619000, liquidityDelta: "1428002846719223" },
          { tick: -11618000, liquidityDelta: "14283134200328356" },
          { tick: -11514000, liquidityDelta: "6326357308254052892" },
          { tick: -11513000, liquidityDelta: "-6323602717467996992" },
          { tick: -10842000, liquidityDelta: "354354407115590582" },
          { tick: -10826000, liquidityDelta: "-354354407115590582" },
          { tick: -10414000, liquidityDelta: "44873653314674335" },
          { tick: -10239000, liquidityDelta: "3061598255308515124" },
          { tick: -10127000, liquidityDelta: "33236074515577012" },
          { tick: -9852000, liquidityDelta: "13916" },
          { tick: -9842000, liquidityDelta: "2076590972603929758" },
          { tick: -9841000, liquidityDelta: "67852361988913196" },
          { tick: -9808000, liquidityDelta: "-44873653314674335" },
          { tick: -9801000, liquidityDelta: "-67852361988913196" },
          { tick: -9740000, liquidityDelta: "1265828824836794" },
          { tick: -9721000, liquidityDelta: "-31618363620669327" },
          { tick: -9698000, liquidityDelta: "34887750432574260" },
          { tick: -9681000, liquidityDelta: "-56113644" },
          { tick: -9407000, liquidityDelta: "-160824311925850" },
          { tick: -9394000, liquidityDelta: "1315082645594336125592" },
          { tick: -9393000, liquidityDelta: "-1315082645594336125592" },
          { tick: -9316000, liquidityDelta: "65749103" },
          { tick: -9287000, liquidityDelta: "10345128838076360680" },
          { tick: -9212000, liquidityDelta: "33476779881989323" },
          { tick: -9211000, liquidityDelta: "1082084400342860223459" },
          { tick: -9210000, liquidityDelta: "-1081923945560101849012" },
          { tick: -9191000, liquidityDelta: "4898292509345703014" },
          { tick: -9190000, liquidityDelta: "120674213479309" },
          { tick: -9189000, liquidityDelta: "-10345128838076360680" },
          { tick: -9115000, liquidityDelta: "887889457513168608" },
          { tick: -9105000, liquidityDelta: "5447965194075007" },
          { tick: -9093000, liquidityDelta: "22626727965140858136" },
          { tick: -9092000, liquidityDelta: "-22626727965140858136" },
          { tick: -9082000, liquidityDelta: "-2076590972603929758" },
          { tick: -9061000, liquidityDelta: "2363252213237431" },
          { tick: -9048000, liquidityDelta: "595439726354817171612" },
          { tick: -8999000, liquidityDelta: "17989897089634390" },
          { tick: -8998000, liquidityDelta: "-17989897089634390" },
          { tick: -8987000, liquidityDelta: "-595410747152912729692" },
          { tick: -8962000, liquidityDelta: "-4898292509345703014" },
          { tick: -8911000, liquidityDelta: "-887889457513168608" },
          { tick: -8852000, liquidityDelta: "24661944808352460" },
          { tick: -8810000, liquidityDelta: "17571997686230064118" },
          { tick: -8700000, liquidityDelta: "9685715740485081431" },
          { tick: -8648000, liquidityDelta: "4185313502561712546" },
          { tick: -8631000, liquidityDelta: "15583353836742940222" },
          { tick: -8623000, liquidityDelta: "128049328343" },
          { tick: -8622000, liquidityDelta: "5900406066402" },
          { tick: -8595000, liquidityDelta: "2240930183625159726" },
          { tick: -8577000, liquidityDelta: "3138984763884628" },
          { tick: -8518000, liquidityDelta: "410184179762199037517" },
          { tick: -8517000, liquidityDelta: "-369437358286939554506" },
          { tick: -8502000, liquidityDelta: "289776995295747181" },
          { tick: -8476000, liquidityDelta: "2614827258145890" },
          { tick: -8455000, liquidityDelta: "30018393385947196056" },
          { tick: -8434000, liquidityDelta: "-21691882563678192103" },
          { tick: -8412000, liquidityDelta: "10798161918128982" },
          { tick: -8369000, liquidityDelta: "148477710414048960" },
          { tick: -8299000, liquidityDelta: "205428248793113931" },
          { tick: -8294000, liquidityDelta: "-2228921822374225799" },
          { tick: -8292000, liquidityDelta: "1497160302630416424" },
          { tick: -8287000, liquidityDelta: "1638391668344533930" },
          { tick: -8286000, liquidityDelta: "1373288643495979037" },
          { tick: -8285000, liquidityDelta: "4154337259745067400" },
          { tick: -8284000, liquidityDelta: "1050794877822776975" },
          { tick: -8279000, liquidityDelta: "1135744762070736463" },
          { tick: -8278000, liquidityDelta: "1518657135962512042" },
          { tick: -8277000, liquidityDelta: "1301243384009522708" },
          { tick: -8268000, liquidityDelta: "1541984271481816732" },
          { tick: -8259000, liquidityDelta: "1914634632444278975" },
          { tick: -8253000, liquidityDelta: "1541647898997119576" },
          { tick: -8243000, liquidityDelta: "1599275786213424096" },
          { tick: -8234000, liquidityDelta: "3660711824240361699" },
          { tick: -8233000, liquidityDelta: "1243775290132910130" },
          { tick: -8224000, liquidityDelta: "1174799838605578955" },
          { tick: -8210000, liquidityDelta: "33771165081390163" },
          { tick: -8190000, liquidityDelta: "373350758453409390373" },
          { tick: -8189000, liquidityDelta: "-373350758453409390373" },
          { tick: -8161000, liquidityDelta: "37603760014507435622" },
          { tick: -8160000, liquidityDelta: "5109274195061354828" },
          { tick: -8153000, liquidityDelta: "-2240930183625159726" },
          { tick: -8123000, liquidityDelta: "26068995717305322" },
          { tick: -8113000, liquidityDelta: "38350797847088141219" },
          { tick: -8112000, liquidityDelta: "-31082700184097481763" },
          { tick: -8074000, liquidityDelta: "3737517395510721583" },
          { tick: -8071000, liquidityDelta: "331934976864180656" },
          { tick: -8046000, liquidityDelta: "-8893764311932860295" },
          { tick: -8041000, liquidityDelta: "80572148572400917" },
          { tick: -8039000, liquidityDelta: "-30023379767472813589" },
          { tick: -8030000, liquidityDelta: "1404722715952847882" },
          { tick: -8029000, liquidityDelta: "2355395250289890891" },
          { tick: -8023000, liquidityDelta: "2991680169275908" },
          { tick: -8021000, liquidityDelta: "84813225389651539" },
          { tick: -8015000, liquidityDelta: "2129046938237799488" },
          { tick: -8010000, liquidityDelta: "71312988965000768" },
          { tick: -8009000, liquidityDelta: "62687174181487282" },
          { tick: -8007000, liquidityDelta: "10966224682884841604495" },
          { tick: -8006000, liquidityDelta: "-10959896933961520360812" },
          { tick: -7987000, liquidityDelta: "8723079408397084" },
          { tick: -7986000, liquidityDelta: "25197541842138621" },
          { tick: -7982000, liquidityDelta: "101590557863089863" },
          { tick: -7980000, liquidityDelta: "95583844024877001" },
          { tick: -7972000, liquidityDelta: "23103085013626369866" },
          { tick: -7971000, liquidityDelta: "2785535279596744355" },
          { tick: -7969000, liquidityDelta: "5119511801216209659" },
          { tick: -7968000, liquidityDelta: "251954049346345753" },
          { tick: -7958000, liquidityDelta: "-3826409515873" },
          { tick: -7953000, liquidityDelta: "83531714445000949" },
          { tick: -7945000, liquidityDelta: "15223052741362489" },
          { tick: -7943000, liquidityDelta: "59633144052324113" },
          { tick: -7938000, liquidityDelta: "211676716299819362438" },
          { tick: -7937000, liquidityDelta: "-209701201211321470944" },
          { tick: -7933000, liquidityDelta: "166368281191190061" },
          { tick: -7932000, liquidityDelta: "81516458444647086" },
          { tick: -7928000, liquidityDelta: "69287532187515441" },
          { tick: -7924000, liquidityDelta: "-3660711824240361699" },
          { tick: -7922000, liquidityDelta: "-2930744241229864003" },
          { tick: -7916000, liquidityDelta: "334971850881467167287" },
          { tick: -7915000, liquidityDelta: "-334971850881467167287" },
          { tick: -7905000, liquidityDelta: "6009751907420358156" },
          { tick: -7902000, liquidityDelta: "71507418949060769" },
          { tick: -7901000, liquidityDelta: "-6268367296171930090" },
          { tick: -7900000, liquidityDelta: "26564617556173828" },
          { tick: -7897000, liquidityDelta: "97962464582733343" },
          { tick: -7896000, liquidityDelta: "222302416282168716" },
          { tick: -7893000, liquidityDelta: "182447567742275540" },
          { tick: -7891000, liquidityDelta: "35194909785792539" },
          { tick: -7888000, liquidityDelta: "2623514399879476172" },
          { tick: -7881000, liquidityDelta: "4031702784409117166" },
          { tick: -7879000, liquidityDelta: "4038704960015969888" },
          { tick: -7876000, liquidityDelta: "13675873553253237274" },
          { tick: -7871000, liquidityDelta: "4871249759892459343" },
          { tick: -7869000, liquidityDelta: "10960344190169647475" },
          { tick: -7866000, liquidityDelta: "4948714015040205950" },
          { tick: -7863000, liquidityDelta: "-14619572078436491610" },
          { tick: -7862000, liquidityDelta: "2433276782602392647" },
          { tick: -7857000, liquidityDelta: "4524393942786730065" },
          { tick: -7855000, liquidityDelta: "12201068386951805" },
          { tick: -7854000, liquidityDelta: "2394084086846592604" },
          { tick: -7841000, liquidityDelta: "78755878016748264" },
          { tick: -7840000, liquidityDelta: "13759099079729277" },
          { tick: -7838000, liquidityDelta: "5382834330493773857" },
          { tick: -7836000, liquidityDelta: "3887212694863697995" },
          { tick: -7834000, liquidityDelta: "72046049264840925" },
          { tick: -7832000, liquidityDelta: "2632487820316834613" },
          { tick: -7830000, liquidityDelta: "3746920886521114930" },
          { tick: -7829000, liquidityDelta: "7528258921246305588" },
          { tick: -7827000, liquidityDelta: "2999951466951065309" },
          { tick: -7826000, liquidityDelta: "974012906915313972" },
          { tick: -7825000, liquidityDelta: "346978244496887728240" },
          { tick: -7824000, liquidityDelta: "125179676680272951590" },
          { tick: -7814000, liquidityDelta: "2421133754728412806" },
          { tick: -7813000, liquidityDelta: "21730726153179579" },
          { tick: -7812000, liquidityDelta: "2392138487032915257" },
          { tick: -7811000, liquidityDelta: "25765571255009542" },
          { tick: -7810000, liquidityDelta: "3655083799181239090" },
          { tick: -7809000, liquidityDelta: "3254005324980660425" },
          { tick: -7788000, liquidityDelta: "4525710842928458050" },
          { tick: -7783000, liquidityDelta: "1312313093979663321" },
          { tick: -7776000, liquidityDelta: "5297292301667159710" },
          { tick: -7770000, liquidityDelta: "31175110955839720" },
          { tick: -7767000, liquidityDelta: "17129978326980021" },
          { tick: -7755000, liquidityDelta: "4369581483787492249" },
          { tick: -7747000, liquidityDelta: "4772327288922699589" },
          { tick: -7746000, liquidityDelta: "5591863430135995363" },
          { tick: -7741000, liquidityDelta: "77957706003706034087" },
          { tick: -7739000, liquidityDelta: "11012907904423313177" },
          { tick: -7732000, liquidityDelta: "12187923891168826" },
          { tick: -7729000, liquidityDelta: "12171319673472903" },
          { tick: -7726000, liquidityDelta: "66815996100329893" },
          { tick: -7723000, liquidityDelta: "88878161598946077" },
          { tick: -7720000, liquidityDelta: "14667763292520760" },
          { tick: -7711000, liquidityDelta: "11106856213877235085" },
          { tick: -7706000, liquidityDelta: "169250670924652247" },
          { tick: -7705000, liquidityDelta: "277389650943764" },
          { tick: -7703000, liquidityDelta: "5890442904272430285" },
          { tick: -7701000, liquidityDelta: "5126833702871214536" },
          { tick: -7697000, liquidityDelta: "234554149957786275924" },
          { tick: -7696000, liquidityDelta: "911627850317491576031" },
          { tick: -7694000, liquidityDelta: "4363581654118202840" },
          { tick: -7692000, liquidityDelta: "38205700590828087555" },
          { tick: -7685000, liquidityDelta: "4165743155389406" },
          { tick: -7684000, liquidityDelta: "242236162095239906" },
          { tick: -7683000, liquidityDelta: "25994065562010684397" },
          { tick: -7682000, liquidityDelta: "10685916142616461454" },
          { tick: -7680000, liquidityDelta: "1241636833458671565" },
          { tick: -7678000, liquidityDelta: "25313893974004984278" },
          { tick: -7676000, liquidityDelta: "11850192587598374725" },
          { tick: -7675000, liquidityDelta: "34646337832049392893" },
          { tick: -7673000, liquidityDelta: "194675310562488839942" },
          { tick: -7672000, liquidityDelta: "-173021465763759654907" },
          { tick: -7670000, liquidityDelta: "1967606823505289348857" },
          { tick: -7669000, liquidityDelta: "-1963273518091201517291" },
          { tick: -7668000, liquidityDelta: "122329419728577016371" },
          { tick: -7667000, liquidityDelta: "88762884500089829495" },
          { tick: -7666000, liquidityDelta: "19073949182813153468" },
          { tick: -7664000, liquidityDelta: "11174631011509229" },
          { tick: -7663000, liquidityDelta: "12864581796792322919" },
          { tick: -7662000, liquidityDelta: "4614781052879179114" },
          { tick: -7661000, liquidityDelta: "46585249018758682" },
          { tick: -7660000, liquidityDelta: "39110012695707748000" },
          { tick: -7659000, liquidityDelta: "42800695802112505173" },
          { tick: -7658000, liquidityDelta: "32839195473979024402" },
          { tick: -7657000, liquidityDelta: "148171734309488658" },
          { tick: -7652000, liquidityDelta: "19260659106044111390" },
          { tick: -7651000, liquidityDelta: "2801426986416879533958" },
          { tick: -7650000, liquidityDelta: "-2563492919639208681537" },
          { tick: -7649000, liquidityDelta: "142034371220865329095" },
          { tick: -7648000, liquidityDelta: "151647606891267971959" },
          { tick: -7647000, liquidityDelta: "84050991428503107329" },
          { tick: -7646000, liquidityDelta: "7830460104152909858" },
          { tick: -7645000, liquidityDelta: "13552944192372255839" },
          { tick: -7643000, liquidityDelta: "-12814306788299319430" },
          { tick: -7642000, liquidityDelta: "18148592117816747024" },
          { tick: -7640000, liquidityDelta: "-1241636833458671565" },
          { tick: -7639000, liquidityDelta: "20922248699878147" },
          { tick: -7638000, liquidityDelta: "-25313893974004984278" },
          { tick: -7636000, liquidityDelta: "-11771829118884280949" },
          { tick: -7635000, liquidityDelta: "-34646337832049392893" },
          { tick: -7633000, liquidityDelta: "4444907850791346970" },
          { tick: -7632000, liquidityDelta: "-21636514284992577830" },
          { tick: -7630000, liquidityDelta: "-4333305414087831566" },
          { tick: -7628000, liquidityDelta: "-75409965512059149314" },
          { tick: -7627000, liquidityDelta: "-88762884500089829495" },
          { tick: -7626000, liquidityDelta: "172921961568002687530" },
          { tick: -7625000, liquidityDelta: "5329282972407934611" },
          { tick: -7624000, liquidityDelta: "214076066313542724" },
          { tick: -7623000, liquidityDelta: "-11744673061906537754" },
          { tick: -7622000, liquidityDelta: "1647268317653655990" },
          { tick: -7621000, liquidityDelta: "-46585249018758682" },
          { tick: -7620000, liquidityDelta: "-39110012695707748000" },
          { tick: -7619000, liquidityDelta: "-42800695802112505173" },
          { tick: -7618000, liquidityDelta: "-32839195473979024402" },
          { tick: -7616000, liquidityDelta: "30608574742349121524" },
          { tick: -7614000, liquidityDelta: "63109263705224609" },
          { tick: -7613000, liquidityDelta: "20992293753739152" },
          { tick: -7612000, liquidityDelta: "-19260659106044111390" },
          { tick: -7611000, liquidityDelta: "-19967810631777415972" },
          { tick: -7610000, liquidityDelta: "-49717730388257328975" },
          { tick: -7609000, liquidityDelta: "-142034371220865329095" },
          { tick: -7608000, liquidityDelta: "-151646704888800831896" },
          { tick: -7607000, liquidityDelta: "-95011335618672754804" },
          { tick: -7606000, liquidityDelta: "-7830460104152909858" },
          { tick: -7605000, liquidityDelta: "-13552944192372255839" },
          { tick: -7604000, liquidityDelta: "5120788242157817993" },
          { tick: -7602000, liquidityDelta: "50550910010426667227" },
          { tick: -7601000, liquidityDelta: "-507374119392725480966" },
          { tick: -7600000, liquidityDelta: "-416058028201150226015" },
          { tick: -7599000, liquidityDelta: "138953466263460" },
          { tick: -7598000, liquidityDelta: "48958902464663392" },
          { tick: -7597000, liquidityDelta: "6644651818095750" },
          { tick: -7596000, liquidityDelta: "4661292826198672278" },
          { tick: -7595000, liquidityDelta: "5523172468970705" },
          { tick: -7593000, liquidityDelta: "-375146328979957062" },
          { tick: -7592000, liquidityDelta: "4637219832093800693" },
          { tick: -7591000, liquidityDelta: "17350263737389014115" },
          { tick: -7590000, liquidityDelta: "41519061985345684" },
          { tick: -7589000, liquidityDelta: "90787402039688838" },
          { tick: -7588000, liquidityDelta: "-29144455540232198711" },
          { tick: -7587000, liquidityDelta: "4458800721123809023" },
          { tick: -7586000, liquidityDelta: "13823972511326282" },
          { tick: -7585000, liquidityDelta: "-5311326266945032045" },
          { tick: -7584000, liquidityDelta: "-207927043313425736" },
          { tick: -7583000, liquidityDelta: "34879160981613956411" },
          { tick: -7582000, liquidityDelta: "13154233901515369124" },
          { tick: -7581000, liquidityDelta: "1489738628437433880" },
          { tick: -7580000, liquidityDelta: "375910511540552074394" },
          { tick: -7579000, liquidityDelta: "-175713312957646853068" },
          { tick: -7578000, liquidityDelta: "134730906347021018180" },
          { tick: -7577000, liquidityDelta: "41173355471322284561" },
          { tick: -7576000, liquidityDelta: "184626125647269633202" },
          { tick: -7575000, liquidityDelta: "315291632450516159" },
          { tick: -7574000, liquidityDelta: "6307786736303191150" },
          { tick: -7573000, liquidityDelta: "19096390060037434745" },
          { tick: -7571000, liquidityDelta: "196237924607786064617" },
          { tick: -7570000, liquidityDelta: "-179072364093229903991" },
          { tick: -7569000, liquidityDelta: "38623159128088621408" },
          { tick: -7568000, liquidityDelta: "159838236768564886597" },
          { tick: -7567000, liquidityDelta: "269164798789357773835" },
          { tick: -7566000, liquidityDelta: "1443608580729106563199" },
          { tick: -7565000, liquidityDelta: "-878516825417017907426" },
          { tick: -7564000, liquidityDelta: "280144681703639206747" },
          { tick: -7563000, liquidityDelta: "322892449948737365747" },
          { tick: -7562000, liquidityDelta: "904311877568562266568" },
          { tick: -7561000, liquidityDelta: "-458267823990174549623" },
          { tick: -7560000, liquidityDelta: "1141106729051463086785" },
          { tick: -7559000, liquidityDelta: "695221922020672946069" },
          { tick: -7558000, liquidityDelta: "229827281552501144589" },
          { tick: -7557000, liquidityDelta: "99380817627359736046" },
          { tick: -7556000, liquidityDelta: "16516433451613017513" },
          { tick: -7555000, liquidityDelta: "26700215604443690698" },
          { tick: -7554000, liquidityDelta: "1181576699821750775" },
          { tick: -7553000, liquidityDelta: "217197860898393333244" },
          { tick: -7552000, liquidityDelta: "-4465357016686790217" },
          { tick: -7551000, liquidityDelta: "436551105772166842216" },
          { tick: -7550000, liquidityDelta: "-325907674300412697670" },
          { tick: -7549000, liquidityDelta: "114234008451772387734" },
          { tick: -7548000, liquidityDelta: "140035484556887374831" },
          { tick: -7547000, liquidityDelta: "-123619798220060425558" },
          { tick: -7546000, liquidityDelta: "34226938924813833168" },
          { tick: -7545000, liquidityDelta: "272854384369945651154" },
          { tick: -7544000, liquidityDelta: "87940051314060135550" },
          { tick: -7543000, liquidityDelta: "-272602936079988746" },
          { tick: -7542000, liquidityDelta: "135463346520359109922" },
          { tick: -7541000, liquidityDelta: "3060071130354807926" },
          { tick: -7540000, liquidityDelta: "-145942022108979150462" },
          { tick: -7539000, liquidityDelta: "-104633220327268645578" },
          { tick: -7538000, liquidityDelta: "123810668978664561886" },
          { tick: -7537000, liquidityDelta: "304295026468123513298" },
          { tick: -7536000, liquidityDelta: "552871271461129988832" },
          { tick: -7535000, liquidityDelta: "309389341143887025024" },
          { tick: -7534000, liquidityDelta: "690803524437243053207" },
          { tick: -7533000, liquidityDelta: "1483612911424155820643" },
          { tick: -7532000, liquidityDelta: "-570952350619703456482" },
          { tick: -7531000, liquidityDelta: "106447752781802719755" },
          { tick: -7530000, liquidityDelta: "112723624342291708548" },
          { tick: -7529000, liquidityDelta: "75259687970585216734" },
          { tick: -7528000, liquidityDelta: "43534514847982580397" },
          { tick: -7527000, liquidityDelta: "-123471580989527538452" },
          { tick: -7526000, liquidityDelta: "-388058878019640903429" },
          { tick: -7525000, liquidityDelta: "-30910797489873888506" },
          { tick: -7524000, liquidityDelta: "-160888392747053601697" },
          { tick: -7523000, liquidityDelta: "827511709075162852248" },
          { tick: -7522000, liquidityDelta: "-524633136115054092771" },
          { tick: -7521000, liquidityDelta: "-61370935547389930871" },
          { tick: -7520000, liquidityDelta: "-673189030812972940035" },
          { tick: -7519000, liquidityDelta: "-548258500098920270725" },
          { tick: -7518000, liquidityDelta: "376617202366049559671" },
          { tick: -7517000, liquidityDelta: "175597590002636377214" },
          { tick: -7516000, liquidityDelta: "335630723798929880245" },
          { tick: -7515000, liquidityDelta: "900923030360740528229" },
          { tick: -7514000, liquidityDelta: "867302543647185073261" },
          { tick: -7513000, liquidityDelta: "794980872673481485790" },
          { tick: -7512000, liquidityDelta: "454548108760824411217" },
          { tick: -7511000, liquidityDelta: "577913786091319647443" },
          { tick: -7510000, liquidityDelta: "410278720207054790954" },
          { tick: -7509000, liquidityDelta: "147466957639640759643" },
          { tick: -7508000, liquidityDelta: "1113775756794041067121" },
          { tick: -7507000, liquidityDelta: "-494561804405553605491" },
          { tick: -7506000, liquidityDelta: "213710450795757284689" },
          { tick: -7505000, liquidityDelta: "-27967072811419456976" },
          { tick: -7504000, liquidityDelta: "289800873573777658213" },
          { tick: -7503000, liquidityDelta: "244307565148210620427" },
          { tick: -7502000, liquidityDelta: "-9885292024716452408" },
          { tick: -7501000, liquidityDelta: "226744114514887414481" },
          { tick: -7500000, liquidityDelta: "33847554748327217131" },
          { tick: -7499000, liquidityDelta: "-79534845983697291422" },
          { tick: -7498000, liquidityDelta: "-186521076364828732535" },
          { tick: -7497000, liquidityDelta: "381503990296623522861" },
          { tick: -7496000, liquidityDelta: "3608011610012246748080" },
          { tick: -7495000, liquidityDelta: "-313241502011479221926" },
          { tick: -7494000, liquidityDelta: "-692263659017610985035" },
          { tick: -7493000, liquidityDelta: "-255392973307393507077" },
          { tick: -7492000, liquidityDelta: "-706064454641709377013" },
          { tick: -7491000, liquidityDelta: "-108780887369446536020" },
          { tick: -7490000, liquidityDelta: "993187912883426565384" },
          { tick: -7489000, liquidityDelta: "-1220084772654741294765" },
          { tick: -7488000, liquidityDelta: "-166822956547156597987" },
          { tick: -7487000, liquidityDelta: "-363400267700205196837" },
          { tick: -7486000, liquidityDelta: "-44881460378137255790" },
          { tick: -7485000, liquidityDelta: "-71886655451123667229" },
          { tick: -7484000, liquidityDelta: "-115606571204983372758" },
          { tick: -7483000, liquidityDelta: "-274866897692785724276" },
          { tick: -7482000, liquidityDelta: "-50954312338719482099" },
          { tick: -7481000, liquidityDelta: "-161424829910431587659" },
          { tick: -7480000, liquidityDelta: "-408082806251685744055" },
          { tick: -7479000, liquidityDelta: "-100896984258668528004" },
          { tick: -7478000, liquidityDelta: "-654713710721608512986" },
          { tick: -7477000, liquidityDelta: "-167671323705347686409" },
          { tick: -7476000, liquidityDelta: "-501973304949755475931" },
          { tick: -7475000, liquidityDelta: "-579902206720229973773" },
          { tick: -7474000, liquidityDelta: "-681855546614608156300" },
          { tick: -7473000, liquidityDelta: "-1373694357212256521846" },
          { tick: -7472000, liquidityDelta: "-265709305182713614757" },
          { tick: -7471000, liquidityDelta: "-568539964793447036306" },
          { tick: -7470000, liquidityDelta: "-274755144936203922337" },
          { tick: -7469000, liquidityDelta: "-179758168661383300697" },
          { tick: -7468000, liquidityDelta: "-240586207783932949632" },
          { tick: -7467000, liquidityDelta: "895007980781867716317" },
          { tick: -7466000, liquidityDelta: "-1290612184415334569339" },
          { tick: -7465000, liquidityDelta: "-205503387496372379076" },
          { tick: -7464000, liquidityDelta: "-264915567197871962035" },
          { tick: -7463000, liquidityDelta: "-295798898140099117216" },
          { tick: -7462000, liquidityDelta: "16183555204811529079" },
          { tick: -7461000, liquidityDelta: "-213966037986335679181" },
          { tick: -7460000, liquidityDelta: "-89665128835872565439" },
          { tick: -7459000, liquidityDelta: "-12155922190830223823" },
          { tick: -7458000, liquidityDelta: "6892866684203560090" },
          { tick: -7457000, liquidityDelta: "459480345799075071" },
          { tick: -7456000, liquidityDelta: "-204431834313403675661" },
          { tick: -7455000, liquidityDelta: "97437920279552082747" },
          { tick: -7454000, liquidityDelta: "126223582411481787158" },
          { tick: -7453000, liquidityDelta: "25801710428077252387" },
          { tick: -7452000, liquidityDelta: "18578974719256567740" },
          { tick: -7451000, liquidityDelta: "48900474792625235960" },
          { tick: -7450000, liquidityDelta: "-99313839500590934185" },
          { tick: -7449000, liquidityDelta: "2642597141565151687" },
          { tick: -7448000, liquidityDelta: "70302034302027849577" },
          { tick: -7447000, liquidityDelta: "9749746612228489921" },
          { tick: -7446000, liquidityDelta: "-165665665382081606689" },
          { tick: -7445000, liquidityDelta: "185342522815012620244" },
          { tick: -7444000, liquidityDelta: "25550133269719878543" },
          { tick: -7443000, liquidityDelta: "7822936009498206681" },
          { tick: -7442000, liquidityDelta: "39357764075380983584" },
          { tick: -7441000, liquidityDelta: "12029122104718705467" },
          { tick: -7440000, liquidityDelta: "589705672146374095" },
          { tick: -7439000, liquidityDelta: "349055770145524175914" },
          { tick: -7438000, liquidityDelta: "731352747894768102927" },
          { tick: -7437000, liquidityDelta: "318815057405161994334" },
          { tick: -7436000, liquidityDelta: "290075670224367385346" },
          { tick: -7435000, liquidityDelta: "-105735486454009041249" },
          { tick: -7434000, liquidityDelta: "178634416171234598072" },
          { tick: -7433000, liquidityDelta: "186260174088585930952" },
          { tick: -7432000, liquidityDelta: "226060508580073539247" },
          { tick: -7431000, liquidityDelta: "173684883380353076687" },
          { tick: -7430000, liquidityDelta: "155258475232539608630" },
          { tick: -7429000, liquidityDelta: "195385445083221894800" },
          { tick: -7428000, liquidityDelta: "658354919333566824334" },
          { tick: -7427000, liquidityDelta: "459861951939818310336" },
          { tick: -7426000, liquidityDelta: "1041624571604857517163" },
          { tick: -7425000, liquidityDelta: "1437427786006912497343" },
          { tick: -7424000, liquidityDelta: "1134670993075786861937" },
          { tick: -7423000, liquidityDelta: "1161638916752597411901" },
          { tick: -7422000, liquidityDelta: "1066316454540428247564" },
          { tick: -7421000, liquidityDelta: "885352367374221918948" },
          { tick: -7420000, liquidityDelta: "692074315874121302342" },
          { tick: -7419000, liquidityDelta: "1453909622888887942912" },
          { tick: -7418000, liquidityDelta: "340394636484576522651" },
          { tick: -7417000, liquidityDelta: "385785704107578896543" },
          { tick: -7416000, liquidityDelta: "242993376852933358106" },
          { tick: -7415000, liquidityDelta: "163636919422219164548" },
          { tick: -7414000, liquidityDelta: "43300181223273170630" },
          { tick: -7413000, liquidityDelta: "62977526339646122439" },
          { tick: -7412000, liquidityDelta: "185452952709649662787" },
          { tick: -7411000, liquidityDelta: "17206262701027962285" },
          { tick: -7410000, liquidityDelta: "136200811394801482400" },
          { tick: -7409000, liquidityDelta: "42366727882905483776" },
          { tick: -7408000, liquidityDelta: "-9224735187702011826" },
          { tick: -7407000, liquidityDelta: "49099612302638651850" },
          { tick: -7406000, liquidityDelta: "-21313673294487516758" },
          { tick: -7405000, liquidityDelta: "-185894257744926815692" },
          { tick: -7404000, liquidityDelta: "-48900513540247399522" },
          { tick: -7403000, liquidityDelta: "92856667241152806245" },
          { tick: -7402000, liquidityDelta: "54320602606531838954" },
          { tick: -7401000, liquidityDelta: "158518200682830505605" },
          { tick: -7400000, liquidityDelta: "42324075585468480774" },
          { tick: -7399000, liquidityDelta: "-409896466608603092155" },
          { tick: -7398000, liquidityDelta: "-602446667615809390078" },
          { tick: -7397000, liquidityDelta: "-438542304602799700131" },
          { tick: -7396000, liquidityDelta: "-232176303451364955284" },
          { tick: -7395000, liquidityDelta: "-127435441107566705682" },
          { tick: -7394000, liquidityDelta: "-211009839148757488691" },
          { tick: -7393000, liquidityDelta: "-52786037560804959948" },
          { tick: -7392000, liquidityDelta: "-167293224878746883558" },
          { tick: -7391000, liquidityDelta: "382623245978678753" },
          { tick: -7390000, liquidityDelta: "-218791584460178654697" },
          { tick: -7389000, liquidityDelta: "216881586341420891027" },
          { tick: -7388000, liquidityDelta: "-20696832582394213337" },
          { tick: -7387000, liquidityDelta: "-144602852696640637452" },
          { tick: -7386000, liquidityDelta: "-422058944023644322450" },
          { tick: -7385000, liquidityDelta: "-1004548084912752333269" },
          { tick: -7384000, liquidityDelta: "-879245951823474380251" },
          { tick: -7383000, liquidityDelta: "-986617479982247388496" },
          { tick: -7382000, liquidityDelta: "-1053268369889167377770" },
          { tick: -7381000, liquidityDelta: "-346148520370161982651" },
          { tick: -7380000, liquidityDelta: "-537480445303512335777" },
          { tick: -7379000, liquidityDelta: "-1269349811466766135460" },
          { tick: -7378000, liquidityDelta: "-386885868089710930053" },
          { tick: -7377000, liquidityDelta: "-255500633517634937189" },
          { tick: -7376000, liquidityDelta: "-113999679874470764611" },
          { tick: -7375000, liquidityDelta: "141234691495216779540" },
          { tick: -7374000, liquidityDelta: "236244955077464555963" },
          { tick: -7373000, liquidityDelta: "337610213140060153297" },
          { tick: -7372000, liquidityDelta: "160955847047584131710" },
          { tick: -7371000, liquidityDelta: "321790841785574824235" },
          { tick: -7370000, liquidityDelta: "-50610772363687260029" },
          { tick: -7369000, liquidityDelta: "301129373388382669502" },
          { tick: -7368000, liquidityDelta: "557038839422605768095" },
          { tick: -7367000, liquidityDelta: "579446079688532905467" },
          { tick: -7366000, liquidityDelta: "488026957273768760825" },
          { tick: -7365000, liquidityDelta: "306321504472878431521" },
          { tick: -7364000, liquidityDelta: "122424784377528817500" },
          { tick: -7363000, liquidityDelta: "20432494400211310203" },
          { tick: -7362000, liquidityDelta: "-31031110470573876170" },
          { tick: -7361000, liquidityDelta: "-46184288690896454165" },
          { tick: -7360000, liquidityDelta: "49855253674488055078" },
          { tick: -7359000, liquidityDelta: "153178790860818610350" },
          { tick: -7358000, liquidityDelta: "-113601903454605403064" },
          { tick: -7357000, liquidityDelta: "-24043912987123171877" },
          { tick: -7356000, liquidityDelta: "-79877243879023328566" },
          { tick: -7355000, liquidityDelta: "-58661324236981915159" },
          { tick: -7354000, liquidityDelta: "-21259739825611743897" },
          { tick: -7353000, liquidityDelta: "184652812192660242004" },
          { tick: -7352000, liquidityDelta: "-277114402749021602529" },
          { tick: -7351000, liquidityDelta: "-149308578142889596052" },
          { tick: -7350000, liquidityDelta: "-146198785835045531687" },
          { tick: -7349000, liquidityDelta: "-493961589455419728491" },
          { tick: -7348000, liquidityDelta: "-476568913045191250648" },
          { tick: -7347000, liquidityDelta: "-366933934593530979688" },
          { tick: -7346000, liquidityDelta: "-609354702587269998015" },
          { tick: -7345000, liquidityDelta: "-469210718337593638513" },
          { tick: -7344000, liquidityDelta: "-449310900351679539342" },
          { tick: -7343000, liquidityDelta: "-180673861494725354972" },
          { tick: -7342000, liquidityDelta: "-172152269193046592527" },
          { tick: -7341000, liquidityDelta: "-539490287780872682129" },
          { tick: -7340000, liquidityDelta: "-317947884625723518798" },
          { tick: -7339000, liquidityDelta: "-117385218450177280447" },
          { tick: -7338000, liquidityDelta: "-161085409648654680543" },
          { tick: -7337000, liquidityDelta: "-138962154506457147552" },
          { tick: -7336000, liquidityDelta: "-153448360270702670549" },
          { tick: -7335000, liquidityDelta: "-312266254871123545988" },
          { tick: -7334000, liquidityDelta: "-326678434028295619513" },
          { tick: -7333000, liquidityDelta: "-468741245271083648498" },
          { tick: -7332000, liquidityDelta: "-351498865914496829811" },
          { tick: -7331000, liquidityDelta: "-435888983250621848287" },
          { tick: -7330000, liquidityDelta: "-121558924114221781966" },
          { tick: -7329000, liquidityDelta: "-467302999826648355818" },
          { tick: -7328000, liquidityDelta: "-521915162364186689455" },
          { tick: -7327000, liquidityDelta: "-688977587047752827863" },
          { tick: -7326000, liquidityDelta: "-603865832450869363122" },
          { tick: -7325000, liquidityDelta: "-352817310160064221926" },
          { tick: -7324000, liquidityDelta: "-52861994863557895216" },
          { tick: -7323000, liquidityDelta: "-150236922203186018799" },
          { tick: -7322000, liquidityDelta: "-37195489106551845281" },
          { tick: -7321000, liquidityDelta: "-115163922860389528061" },
          { tick: -7320000, liquidityDelta: "-104754006408585321070" },
          { tick: -7319000, liquidityDelta: "-23883303993210440470" },
          { tick: -7318000, liquidityDelta: "-2363712588879485850" },
          { tick: -7317000, liquidityDelta: "-39335537259785438448" },
          { tick: -7316000, liquidityDelta: "-11660709608730853288" },
          { tick: -7315000, liquidityDelta: "-13076367470710239042" },
          { tick: -7314000, liquidityDelta: "-95165687255704641016" },
          { tick: -7313000, liquidityDelta: "-802610439310611413828" },
          { tick: -7312000, liquidityDelta: "-15845667897353641344" },
          { tick: -7311000, liquidityDelta: "-55349682278555875" },
          { tick: -7310000, liquidityDelta: "-6704102776956205915" },
          { tick: -7309000, liquidityDelta: "-2133163177901919135" },
          { tick: -7308000, liquidityDelta: "-2592339795341596838" },
          { tick: -7307000, liquidityDelta: "-4239157020915327532" },
          { tick: -7305000, liquidityDelta: "-12240569367151987428" },
          { tick: -7303000, liquidityDelta: "-4097068991313077684" },
          { tick: -7300000, liquidityDelta: "-27754701842019491364" },
          { tick: -7294000, liquidityDelta: "-1290472805781016" },
          { tick: -7293000, liquidityDelta: "-15552066764559054555" },
          { tick: -7281000, liquidityDelta: "-16442692703803783575" },
          { tick: -7280000, liquidityDelta: "-15965831575809642703" },
          { tick: -7279000, liquidityDelta: "-85284464488177600670" },
          { tick: -7275000, liquidityDelta: "-298386527355060174" },
          { tick: -7274000, liquidityDelta: "-15992259089564857118" },
          { tick: -7273000, liquidityDelta: "-16498368812877245957" },
          { tick: -7270000, liquidityDelta: "-1406716413876467959" },
          { tick: -7269000, liquidityDelta: "-1565382274028712413" },
          { tick: -7268000, liquidityDelta: "-3296441369305937785" },
          { tick: -7267000, liquidityDelta: "-1457938114231079870" },
          { tick: -7266000, liquidityDelta: "-36810338826620693" },
          { tick: -7265000, liquidityDelta: "-2914304029269129784" },
          { tick: -7264000, liquidityDelta: "-18646110885451303577" },
          { tick: -7262000, liquidityDelta: "-671803186854710017" },
          { tick: -7259000, liquidityDelta: "-2785535279596744355" },
          { tick: -7258000, liquidityDelta: "-12909885319969506940" },
          { tick: -7254000, liquidityDelta: "-313393201433147508" },
          { tick: -7253000, liquidityDelta: "-2175974565786595455" },
          { tick: -7252000, liquidityDelta: "-122809863278875425" },
          { tick: -7251000, liquidityDelta: "-335112210736259565" },
          { tick: -7250000, liquidityDelta: "-4560079829893267743" },
          { tick: -7249000, liquidityDelta: "-44569642719165875" },
          { tick: -7248000, liquidityDelta: "-21277548156603436" },
          { tick: -7247000, liquidityDelta: "-23889386738233790" },
          { tick: -7246000, liquidityDelta: "-1092648318920769641" },
          { tick: -7245000, liquidityDelta: "-21349953717158132610" },
          { tick: -7244000, liquidityDelta: "-4746855312116958412499" },
          { tick: -7241000, liquidityDelta: "-39658213665819472" },
          { tick: -7237000, liquidityDelta: "-1488399018985172527" },
          { tick: -7236000, liquidityDelta: "-1208884052206951" },
          { tick: -7231000, liquidityDelta: "-974012906915313972" },
          { tick: -7230000, liquidityDelta: "-9544581028352594936" },
          { tick: -7227000, liquidityDelta: "-113954817904689866" },
          { tick: -7220000, liquidityDelta: "-4556131987452651189" },
          { tick: -7213000, liquidityDelta: "-88878161598946077" },
          { tick: -7211000, liquidityDelta: "-4449659655245899758" },
          { tick: -7208000, liquidityDelta: "18731267875311630596" },
          { tick: -7195000, liquidityDelta: "-49209158262333839" },
          { tick: -7193000, liquidityDelta: "-26564617556173828" },
          { tick: -7191000, liquidityDelta: "-2121553727144299515" },
          { tick: -7189000, liquidityDelta: "-157679570666792941" },
          { tick: -7186000, liquidityDelta: "-56654942788662161" },
          { tick: -7185000, liquidityDelta: "-3286478470712362363" },
          { tick: -7184000, liquidityDelta: "-21697804827960511" },
          { tick: -7180000, liquidityDelta: "-27668089528725429" },
          { tick: -7178000, liquidityDelta: "-8713491432926828866" },
          { tick: -7175000, liquidityDelta: "-23018907518342302" },
          { tick: -7174000, liquidityDelta: "-14054733109782031" },
          { tick: -7171000, liquidityDelta: "-38983130354681282" },
          { tick: -7170000, liquidityDelta: "-58294463206680404113" },
          { tick: -7169000, liquidityDelta: "-1236849689593540597" },
          { tick: -7162000, liquidityDelta: "-40384516897920128" },
          { tick: -7161000, liquidityDelta: "-20542022375986541" },
          { tick: -7159000, liquidityDelta: "-38561560217648688" },
          { tick: -7155000, liquidityDelta: "-239482664608257597" },
          { tick: -7138000, liquidityDelta: "-152471225320033099" },
          { tick: -7132000, liquidityDelta: "-289776995295747181" },
          { tick: -7131000, liquidityDelta: "-3551697015881882663" },
          { tick: -7122000, liquidityDelta: "-148171734309488658" },
          { tick: -7118000, liquidityDelta: "-131075417264495341" },
          { tick: -7116000, liquidityDelta: "-503647042833846586" },
          { tick: -7112000, liquidityDelta: "-6644651818095750" },
          { tick: -7110000, liquidityDelta: "-84448218017724886" },
          { tick: -7109000, liquidityDelta: "-38102452202283934" },
          { tick: -7108000, liquidityDelta: "-668110455925567268" },
          { tick: -7105000, liquidityDelta: "-26068995717305322" },
          { tick: -7104000, liquidityDelta: "-77411261901001127" },
          { tick: -7101000, liquidityDelta: "-64268349313859430" },
          { tick: -7100000, liquidityDelta: "-172001969605985494" },
          { tick: -7098000, liquidityDelta: "-25394516594769306" },
          { tick: -7097000, liquidityDelta: "-50566547241053549" },
          { tick: -7096000, liquidityDelta: "-90539470981544013" },
          { tick: -7094000, liquidityDelta: "-28408092299028664" },
          { tick: -7092000, liquidityDelta: "-17323654011626217" },
          { tick: -7091000, liquidityDelta: "-498479149716221094" },
          { tick: -7090000, liquidityDelta: "-26857216712617447592" },
          { tick: -7089000, liquidityDelta: "-17330513736607205" },
          { tick: -7082000, liquidityDelta: "-17285920975111538" },
          { tick: -7081000, liquidityDelta: "-266539825660450452" },
          { tick: -7080000, liquidityDelta: "-116698368516947880" },
          { tick: -7073000, liquidityDelta: "-5196914475550990020" },
          { tick: -7066000, liquidityDelta: "-252238807712585082" },
          { tick: -7051000, liquidityDelta: "-12040243378508931" },
          { tick: -7048000, liquidityDelta: "-215705111808626375" },
          { tick: -7042000, liquidityDelta: "-6009751907420358156" },
          { tick: -7029000, liquidityDelta: "-744501009036804475" },
          { tick: -7028000, liquidityDelta: "-85364155170067964" },
          { tick: -7024000, liquidityDelta: "-280974561304595990" },
          { tick: -7023000, liquidityDelta: "310479683775947364" },
          { tick: -7022000, liquidityDelta: "-110893134197794851" },
          { tick: -7021000, liquidityDelta: "-81516458444647086" },
          { tick: -7019000, liquidityDelta: "-14667763292520760" },
          { tick: -7018000, liquidityDelta: "-334676038232559" },
          { tick: -7016000, liquidityDelta: "-84225621106955848" },
          { tick: -7015000, liquidityDelta: "-1776446441990637" },
          { tick: -7014000, liquidityDelta: "-981143435818518" },
          { tick: -7013000, liquidityDelta: "-272812901795826391" },
          { tick: -7012000, liquidityDelta: "-4443069560274378" },
          { tick: -7011000, liquidityDelta: "-25765571255009542" },
          { tick: -7009000, liquidityDelta: "-21730726153179579" },
          { tick: -7008000, liquidityDelta: "-80572148572400917" },
          { tick: -7004000, liquidityDelta: "-14606704637077797" },
          { tick: -7003000, liquidityDelta: "-2521761973898468173" },
          { tick: -7001000, liquidityDelta: "-3254005324980660425" },
          { tick: -6987000, liquidityDelta: "-4031702784409117166" },
          { tick: -6983000, liquidityDelta: "-4136667424598703231" },
          { tick: -6980000, liquidityDelta: "-197927338307284969" },
          { tick: -6978000, liquidityDelta: "-69287532187515441" },
          { tick: -6976000, liquidityDelta: "-4369581483787492249" },
          { tick: -6974000, liquidityDelta: "-8374289179426681708" },
          { tick: -6973000, liquidityDelta: "-3887212694863697995" },
          { tick: -6969000, liquidityDelta: "-5382834330493773857" },
          { tick: -6964000, liquidityDelta: "-4871249759892459343" },
          { tick: -6958000, liquidityDelta: "-4772327288922699589" },
          { tick: -6957000, liquidityDelta: "-11482306334408425648" },
          { tick: -6955000, liquidityDelta: "-4525710842928458050" },
          { tick: -6954000, liquidityDelta: "-7484438282031836513" },
          { tick: -6953000, liquidityDelta: "-2962445537352788920" },
          { tick: -6951000, liquidityDelta: "-9875109588079186692" },
          { tick: -6948000, liquidityDelta: "-2999951466951065309" },
          { tick: -6945000, liquidityDelta: "-3073092673796486605" },
          { tick: -6943000, liquidityDelta: "-318056752489836035" },
          { tick: -6942000, liquidityDelta: "-11012907904423313177" },
          { tick: -6941000, liquidityDelta: "-4278217498948134876" },
          { tick: -6940000, liquidityDelta: "-2433276782602392647" },
          { tick: -6939000, liquidityDelta: "-199620081649443008" },
          { tick: -6933000, liquidityDelta: "-28897617524138433087" },
          { tick: -6928000, liquidityDelta: "-9821686244453889775" },
          { tick: -6927000, liquidityDelta: "-206993126109250866" },
          { tick: -6924000, liquidityDelta: "-5298361842239992453" },
          { tick: -6922000, liquidityDelta: "-59633144052324113" },
          { tick: -6920000, liquidityDelta: "-4632097517713516130" },
          { tick: -6919000, liquidityDelta: "-2758230347253603328" },
          { tick: -6918000, liquidityDelta: "-2465397075811593372" },
          { tick: -6917000, liquidityDelta: "-25197541842138621" },
          { tick: -6916000, liquidityDelta: "-2483820928909900088" },
          { tick: -6915000, liquidityDelta: "-211522647445817272" },
          { tick: -6914000, liquidityDelta: "-114032898764212494" },
          { tick: -6913000, liquidityDelta: "-66815996100329893" },
          { tick: -6911000, liquidityDelta: "-2392138487032915257" },
          { tick: -6910000, liquidityDelta: "-84813225389651539" },
          { tick: -6909000, liquidityDelta: "-1301243384009522708" },
          { tick: -6908000, liquidityDelta: "-40702634937082763743" },
          { tick: -6907000, liquidityDelta: "-3842282274054904666" },
          { tick: -6903000, liquidityDelta: "-2355395250289890891" },
          { tick: -6900000, liquidityDelta: "-3411791108665179526" },
          { tick: -6898000, liquidityDelta: "-1160220980116534929" },
          { tick: -6894000, liquidityDelta: "-4123929255015320201" },
          { tick: -6893000, liquidityDelta: "-1050794877822776975" },
          { tick: -6890000, liquidityDelta: "-2805930646117630205" },
          { tick: -6885000, liquidityDelta: "-1826766665053565344" },
          { tick: -6884000, liquidityDelta: "-1638391668344533930" },
          { tick: -6875000, liquidityDelta: "-8723079408397084" },
          { tick: -6873000, liquidityDelta: "-1373288643495979037" },
          { tick: -6857000, liquidityDelta: "-2129046938237799488" },
          { tick: -6851000, liquidityDelta: "-439054806096889167" },
          { tick: -6839000, liquidityDelta: "-1174799838605578955" },
          { tick: -6801000, liquidityDelta: "62485577124653946156" },
          { tick: -6789000, liquidityDelta: "-63949820277029267476" },
          { tick: -6767000, liquidityDelta: "-11106856213877235085" },
          { tick: -6766000, liquidityDelta: "-24661944808352460" },
          { tick: -6717000, liquidityDelta: "-886633800150008228" },
          { tick: -6685000, liquidityDelta: "-16279824728607237" },
          { tick: -6551000, liquidityDelta: "-265007956239038776" },
          { tick: -6502000, liquidityDelta: "38745220022758029050" },
          { tick: -6501000, liquidityDelta: "-38745220022758029050" },
          { tick: -6430000, liquidityDelta: "-3138984763884628" },
          { tick: -6429000, liquidityDelta: "-1265828824836794" },
          { tick: -6419000, liquidityDelta: "-10560386534257657" },
          { tick: -6368000, liquidityDelta: "376998726847579354" },
          { tick: -6332000, liquidityDelta: "-184684420078210528" },
          { tick: -6255000, liquidityDelta: "-376998726847579354" },
          { tick: -6215000, liquidityDelta: "-6362444427213702" },
          { tick: -5991000, liquidityDelta: "-9126408651139885512" },
          { tick: -5844000, liquidityDelta: "-4503309" },
          { tick: -5838000, liquidityDelta: "-450584" },
          { tick: -5805000, liquidityDelta: "-42012" },
          { tick: -5447000, liquidityDelta: "-40950678" },
          { tick: -5442000, liquidityDelta: "-549763" },
          { tick: -5094000, liquidityDelta: "-29317259492" },
          { tick: -5088000, liquidityDelta: "-45080" },
          { tick: -5081000, liquidityDelta: "-41921043" },
          { tick: -5049000, liquidityDelta: "-2363252213237431" },
          { tick: -4812000, liquidityDelta: "-418" },
          { tick: -4605000, liquidityDelta: "-38924745076064330" },
          { tick: -3912000, liquidityDelta: "56583420290370869292" },
          { tick: -3911000, liquidityDelta: "-56583420290370869292" },
          { tick: -3135000, liquidityDelta: "-144433471" },
          { tick: -2639000, liquidityDelta: "-35815116" },
          { tick: -2565000, liquidityDelta: "-54848" },
          { tick: -2398000, liquidityDelta: "-53556408363" },
          { tick: -2397000, liquidityDelta: "-548894014231978350" },
          { tick: -2304000, liquidityDelta: "158041738186699052361" },
          { tick: -2303000, liquidityDelta: "-158010121951469691426" },
          { tick: -2079000, liquidityDelta: "5803242591119667226" },
          { tick: -1825000, liquidityDelta: "2554299719866792331" },
          { tick: -1792000, liquidityDelta: "2514117783154043893" },
          { tick: -1609000, liquidityDelta: "-121640321586903125" },
          { tick: -693000, liquidityDelta: "5803726672055667550272" },
          { tick: -692000, liquidityDelta: "-5800156018768350269662" },
          { tick: -20000, liquidityDelta: "5574083606662000709925" },
          { tick: -1000, liquidityDelta: "4133534077022657330976" },
          { tick: 0, liquidityDelta: "13768690052676841309266" },
          { tick: 1000, liquidityDelta: "-18004533531315375742466" },
          { tick: 20000, liquidityDelta: "-5474582723330481259809" },
          { tick: 105000, liquidityDelta: "-30462508538687517" },
          { tick: 117000, liquidityDelta: "3775650927801693341" },
          { tick: 223000, liquidityDelta: "1968625214372114447269" },
          { tick: 224000, liquidityDelta: "-1968091404166818346289" },
          { tick: 501000, liquidityDelta: "783586453782530747945" },
          { tick: 502000, liquidityDelta: "-783586453782530747945" },
          { tick: 693000, liquidityDelta: "2825341816538986746608" },
          { tick: 694000, liquidityDelta: "-2828927025326774579174" },
          { tick: 1204000, liquidityDelta: "431866715454759940" },
          { tick: 1609000, liquidityDelta: "4919497700863794730200" },
          { tick: 1610000, liquidityDelta: "-4919502697111649342514" },
          { tick: 1772000, liquidityDelta: "-4240831498865499" },
          { tick: 2120000, liquidityDelta: "1385798910477534629551" },
          { tick: 2121000, liquidityDelta: "-1385804426483898401338" },
          { tick: 2207000, liquidityDelta: "-2736051072210277" },
          { tick: 2303000, liquidityDelta: "8535750767233406788215" },
          { tick: 2304000, liquidityDelta: "-8536035838243232701508" },
          { tick: 2526000, liquidityDelta: "-2030646113816693" },
          { tick: 2659000, liquidityDelta: "-1775673957086832" },
          { tick: 2996000, liquidityDelta: "6539788613358035869" },
          { tick: 4423000, liquidityDelta: "-2991680169275908" },
          { tick: 4605000, liquidityDelta: "2000425408465256039842" },
          { tick: 4606000, liquidityDelta: "-2000328517407682258457" },
          { tick: 4828000, liquidityDelta: "178901970448377598821" },
          { tick: 4829000, liquidityDelta: "-178901970448377598821" },
          { tick: 5298000, liquidityDelta: "-12345388614732885956" },
          { tick: 5521000, liquidityDelta: "-5068417503020836224" },
          { tick: 5684000, liquidityDelta: "106356680996017999597" },
          { tick: 5685000, liquidityDelta: "-106356680996017999597" },
          { tick: 6898000, liquidityDelta: "2685496131222650027384" },
          { tick: 6908000, liquidityDelta: "113509076319412905798902" },
          { tick: 6909000, liquidityDelta: "-113509099899341324819878" },
          { tick: 6911000, liquidityDelta: "2412076298561923058322" },
          { tick: 6917000, liquidityDelta: "4054585807256085860160" },
          { tick: 6920000, liquidityDelta: "2678877035284710616544" },
          { tick: 6999000, liquidityDelta: "2336462925366978918460" },
          { tick: 7003000, liquidityDelta: "6074591474892601350993" },
          { tick: 7012000, liquidityDelta: "2706760732903206585090" },
          { tick: 7090000, liquidityDelta: "2794568433076927222728" },
          { tick: 7143000, liquidityDelta: "-736327965381397663" },
          { tick: 7378000, liquidityDelta: "2896641459660680668" },
          { tick: 7387000, liquidityDelta: "194824255738905820187" },
          { tick: 7427000, liquidityDelta: "-194824255738905820187" },
          { tick: 7551000, liquidityDelta: "-2896641459660680668" },
          { tick: 7779000, liquidityDelta: "-2336462925366978918460" },
          { tick: 7800000, liquidityDelta: "-2685496131222650027384" },
          { tick: 7804000, liquidityDelta: "-2965581371521256394089" },
          { tick: 7808000, liquidityDelta: "-2794568433076927222728" },
          { tick: 7809000, liquidityDelta: "-3109010103371344956904" },
          { tick: 7815000, liquidityDelta: "-1658974660185782835216" },
          { tick: 7819000, liquidityDelta: "-7486564480916936699810" },
          { tick: 7832000, liquidityDelta: "-2706760732903206585090" },
          { tick: 8006000, liquidityDelta: "-1479969629425852" },
          { tick: 8176000, liquidityDelta: "-436341095474841" },
          { tick: 8227000, liquidityDelta: "-548208973863681" },
          { tick: 8343000, liquidityDelta: "-1341434178436689" },
          { tick: 8422000, liquidityDelta: "-739279280137765" },
          { tick: 8455000, liquidityDelta: "-276240041140886" },
          { tick: 8517000, liquidityDelta: "-419360440784657" },
          { tick: 9210000, liquidityDelta: "20023527617665235497811" },
          { tick: 9211000, liquidityDelta: "-20001560080274680655467" },
          { tick: 9903000, liquidityDelta: "-12748825975476229" },
          { tick: 10485000, liquidityDelta: "-160836185686692914" },
          { tick: 10820000, liquidityDelta: "10730004458332" },
          { tick: 10821000, liquidityDelta: "-10730004458332" },
          { tick: 11513000, liquidityDelta: "-23142375559021959783" },
          { tick: 13409000, liquidityDelta: "326508638200609984082" },
          { tick: 13410000, liquidityDelta: "-326508638200609984082" },
          { tick: 16023000, liquidityDelta: "4410582267018" },
          { tick: 18325000, liquidityDelta: "-4410582267018" },
          { tick: 18421000, liquidityDelta: "-24845778886" },
          { tick: 20068000, liquidityDelta: "1279956998801643410127829" },
          { tick: 20088000, liquidityDelta: "3440719210005020805532645" },
          { tick: 20108000, liquidityDelta: "-1279956998801643410127829" },
          { tick: 20128000, liquidityDelta: "-3440719210005020805532645" },
          { tick: 20160000, liquidityDelta: "5985567728132048283538142" },
          { tick: 20199000, liquidityDelta: "12287424231126263378533" },
          { tick: 20200000, liquidityDelta: "-5985567728132048283538142" },
          { tick: 20212000, liquidityDelta: "17757637651604603422614" },
          { tick: 20239000, liquidityDelta: "-12287424231126263378533" },
          { tick: 20277000, liquidityDelta: "-17757637651604603422614" },
          { tick: 25635000, liquidityDelta: "2704911643306589756137939" },
          { tick: 25772000, liquidityDelta: "237773311795146358827717038" },
          { tick: 25792000, liquidityDelta: "133888493525547773451389740" },
          { tick: 25812000, liquidityDelta: "-237773311795146358827717038" },
          { tick: 25832000, liquidityDelta: "-133888493525547773451389740" },
          { tick: 25928000, liquidityDelta: "-2704911643306589756137939" },
          { tick: 88722000, liquidityDelta: "-2894395331512621112" },
        ].map(({ tick, liquidityDelta }) => ({
          tick,
          liquidityDelta: BigInt(liquidityDelta),
        })),
        liquidity: 3214722905666182801858n,
      });

      expect(
        node.quote({
          tokenAmount: {
            amount: -550761295858476146n,
            token: 0n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 263928464145073n,
          "consumedAmount": -550761295858476146n,
          "executionResources": {
            "initializedTicksCrossed": 0,
            "tickSpacingsCrossed": 0,
          },
          "feesPaid": 131964232073n,
          "isPriceIncreasing": true,
          "stateAfter": {
            "activeTickIndex": 257,
            "liquidity": 3214722905666182801858n,
            "sqrtRatio": 7447200854403535845014925589223357062n,
          },
        }
      `);
    });

    it("dai usdc example pool", () => {
      const node = new BasePool({
        token0: 0n,
        token1: 1n,
        tickSpacing: 1,
        fee: 17014118346046923173168730371588410572n,
        sqrtRatio: 340492544394014493270092018910666n,
        tick: -27629800,
        liquidity: 0x5f1a9b05d4n,
        sortedTicks: [
          { tick: -29546100, liquidityDelta: "408468260308" },
          { tick: -27735210, liquidityDelta: "32375395228589" },
          { tick: -27639900, liquidityDelta: "-32375395228589" },
          { tick: -25733700, liquidityDelta: "-408468260308" },
        ].map(({ tick, liquidityDelta }) => ({
          tick,
          liquidityDelta: BigInt(liquidityDelta),
        })),
      });

      expect(
        node.quote({
          tokenAmount: {
            amount: -1_000_000_000n,
            token: 1n,
          },
          meta: { block: { number: 1, time: 2 } },
        }),
      ).toMatchInlineSnapshot(`
        {
          "calculatedAmount": 2361232818001044269n,
          "consumedAmount": -1751932n,
          "executionResources": {
            "initializedTicksCrossed": 3,
            "tickSpacingsCrossed": 243398,
          },
          "feesPaid": 118061640900052215n,
          "isPriceIncreasing": false,
          "stateAfter": {
            "activeTickIndex": -1,
            "liquidity": 0n,
            "sqrtRatio": 18446748437148339061n,
          },
        }
      `);
    });
  });
});
